<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>使用 Docker-Compose 搭建 Jenkins | 酸辣土豆丝 iCS</title>
<meta name=keywords content="tech,docker,jenkins"><meta name=description content="这篇文章介绍了使用 Docker 搭建 Jenkins 的主要安装步骤和权限问题处理。对于 Docker 权限问题，可以将容器内部的用户添加到宿主机的 Docker 组中；对于映射目录权限问题，可以手动创建目录并分配权限，或者修改已创建目录的权限。"><meta name=author content="Spring"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="xkB2VH159BqxPq1aGZjUYzx0I0g7V88UGVtyllS-kD4"><meta name=msvalidate.01 content="9C8D84968D4763DB920DCBA257ECDFB0"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://blog.springx.fun/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://blog.springx.fun/favicon16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.springx.fun/favicon32.png><link rel=apple-touch-icon href=https://blog.springx.fun/favicon.png><link rel=mask-icon href=https://blog.springx.fun/favicon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.springx.fun/posts/tech/docker-compose-install-jenkins/><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?2dc9d9029e9c005e851cae0b71d1e424",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="使用 Docker-Compose 搭建 Jenkins"><meta property="og:description" content="这篇文章介绍了使用 Docker 搭建 Jenkins 的主要安装步骤和权限问题处理。对于 Docker 权限问题，可以将容器内部的用户添加到宿主机的 Docker 组中；对于映射目录权限问题，可以手动创建目录并分配权限，或者修改已创建目录的权限。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.springx.fun/posts/tech/docker-compose-install-jenkins/"><meta property="og:image" content="https://blog.springx.fun/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-21T21:39:09+08:00"><meta property="article:modified_time" content="2023-08-21T21:39:09+08:00"><meta property="og:site_name" content="酸辣土豆丝 iCS"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.springx.fun/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="使用 Docker-Compose 搭建 Jenkins"><meta name=twitter:description content="这篇文章介绍了使用 Docker 搭建 Jenkins 的主要安装步骤和权限问题处理。对于 Docker 权限问题，可以将容器内部的用户添加到宿主机的 Docker 组中；对于映射目录权限问题，可以手动创建目录并分配权限，或者修改已创建目录的权限。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.springx.fun/posts/"},{"@type":"ListItem","position":2,"name":"使用 Docker-Compose 搭建 Jenkins","item":"https://blog.springx.fun/posts/tech/docker-compose-install-jenkins/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用 Docker-Compose 搭建 Jenkins","name":"使用 Docker-Compose 搭建 Jenkins","description":"这篇文章介绍了使用 Docker 搭建 Jenkins 的主要安装步骤和权限问题处理。对于 Docker 权限问题，可以将容器内部的用户添加到宿主机的 Docker 组中；对于映射目录权限问题，可以手动创建目录并分配权限，或者修改已创建目录的权限。","keywords":["tech","docker","jenkins"],"articleBody":"00 碎碎念 为什么使用 Docker 去搭建 Jenkins 呢？\n主要原因是个人频繁切换环境，有时候在本地虚拟机玩，有时候会在云服务器上折腾，渐感被自己折磨过多了，因此希望能够创建一个配置文件，以便一键启动并快速方便地使用。另外，自己经常在其他地方装环境，公司的服务也比较老，一但要迁移，用 Docker 就很方便。所以，使用 Docker 是很适合的。\n网上那么多一样的文章，为什么要写这篇呢？\n虽然说这篇文章是作为笔记的，但是因为自己在使用网上的方法安装的时候，遇到几个问题，尝试了很多方法才成功，所以想要记录一下，以备不时之需。\n01 Docker Compose 安装 以下是测试过的，能正常部署和使用 Jenkins 的 Docker Compose 配置，部分参数请按需调整。\nversion: '3.9' services: jenkins: # 镜像选择了 jdk17 最新版，可自行选择 image: jenkins/jenkins:jdk17 container_name: jenkins # 重启策略：除非手动停止，否则出错会无限重启 restart: unless-stopped # 指定用户 uid:gid（`用户id`:`宿主机的docker组id`，跟文件权限有关） user: 1000:995 ports: # 8080 为 Jenkins 的 Web 端口 - 9001:8080 # 50000 为代理节点与主服务器的通信端口？ - 50001:50000 volumes: # 同步宿主机的时间 - /etc/timezone:/etc/timezone - /etc/localtime:/etc/localtime # Jenkins 数据目录映射出来，方面操作和备份 - .jenkins_home:/var/jenkins_home # 把宿主机的 docker 和 docker-compose 给 Jenkins 使用，这样可以直接在 Jenkins 内部打镜像，并直接操作容器 - /usr/bin/docker:/usr/bin/docker - /var/run/docker.sock:/var/run/docker.sock - /usr/local/bin/docker-compose:/usr/local/bin/docker-compose 使用 Docker Compose 直接启动即可：\n# -d：后台启动 $ docker-compose up -d # 1. 查看日志，临时登录密码会放到文件中，也会直接打在日志上 # 临时密码位置：/var/jenkins_home/secrets/initialAdminPassword # 2. 或使用 docker 命令查看： docker logs jenkins $ docker-compose logs -f Jenkins initial setup is required.An admin user has been created and a password generated. Please use the following password to proceed to installation: # 临时密码 57ea14a04f9464d895655348d6ad6a86 然后，访问 9001（这里已经映射为 9001 端口了）：http://ip:9001，输入临时密码登录。\n接着，选择安装插件，创建用户，等待完成即可。（这些步骤都可以跳过，后续再进行即可）\n02 问题及解决办法 2.1 Docker 权限问题（Permission denied） 用网上的方法，折腾了好久……\n把 Docker 相关文件映射到容器内部后，会遇到权限问题（如果直接指定 root 用户部署，不会有权限问题！），网上有许多把 jenkins 用户添加到 docker 组的方式，但这依然是基于宿主机的环境，未必能直接解决。\n我比较爱折腾，环境稍微有差异，直接把 jenkins 用户添加到 docker 组依然有权限问题，接下来看看具体的情况和处理方法。\n事情是这样子的~\n首先，来看看 docker.sock 在 Jenkins 容器内部的情况：\njenkins@b0e6d3e8ce07:~$ ls -l /var/run/ | grep docker srw-rw----. 1 root 998 0 Jun 3 01:59 docker.sock docker.sock 是我们从宿主机映射到容器内的 sock 文件，它是 Docker 守护进程（Docker daemon）与 Docker 客户端之间进行通信的 UNIX 套接字文件（UNIX socket file）。\n由于 docker 相关文件是属于宿主机的，原则上不直接修改它，而是通过修改容器来兼容。但是，这里的 sock 属于 root 用户，如果使用普通用户（默认 jenkins:1000）部署，并没有权限去读取。\n998 是 docker 组的组 id（gid），网上找到比较好的方法是，把 jenkins 用户直接加入该组，就可以正常使用宿主机 docker 了。\n而我的问题就出在这里。\n先用网上的方法试试？\n接着，来看下容器内部的情况：\njenkins@b0e6d3e8ce07:~$ id jenkins uid=1000(jenkins) gid=1000(jenkins) groups=1000(jenkins) jenkins@b0e6d3e8ce07:~$ id uid=1000(jenkins) gid=995 groups=995 # 下面是配置 `user: root` 部署的，容器内部使用 root 用户，可以正常使用 docker root@8900354a95f1:/# id uid=0(root) gid=0(root) groups=0(root) 第一个命令，id jenkins 表明 jenkins 用户的用户 id 和组 id 都为 1000；\n第二个命令，id 表明当前登录会话的用户 id 为 1000，而组 id 和 groups 为 995（为什么不一样？因为 docker-compose 配置文件设置的，groups 就是重点）。\n也就是说，当前登录会话的用户，既不是 root 用户，也不属于 998 组，所有没有权限读取 docker.sock。\n所以，到这儿得先把 jenkins 加入 998 组，否则不可能有权限的。这个 docker 组应该不存在，我们需要先创建该组，然后再把 jenkins 加入：\n# 先退出容器，使用 root 登录（-u 指定登录用户） $ sudo docker exec -it -u root jenkins bash # 然后，创建 docker 组，指定与 docker.sock 一样的组 id # groupadd -g $ groupadd -g 998 docker # 最后，把 jenkins 加入该组 # usermod -a -G $ usermod -aG docker jenkins 到这一步，我还是没有权限，重启容器也没有用，这是为什么呢？\n一路走到黑？\n折腾了很久都没效果，本来已经要放弃了，就在宿主机试验了一遍：docker 组已经存在，把普通用户加入 docker，重新登录，普通用户居然有权限了！\n[springx@** ~]$ id uid=1000(springx) gid=1000(springx) groups=1000(springx),995(docker) context=un... 可以看出，在宿主机中，当前登录的用户的会话是包含 docker 组的（groups = 1000，995，宿主机的 docker 组 id 正好为 995）。\n相反的是，在容器内部，即使修改了用户组，登录会话的组还是 docker-compose 配置的 995（groups），所以怎么试都没有权限。\n找到问题的根源：有没有权限，与登录会话有关，需要拥有 docker 组的权限才可以。\n既然知道了问题的根源，那如何让登录会话拥有 docker 组权限呢？\n临时测试方法（newgrp）\n想要修改登录会话所属组，就要修改登录身份。也就是说，用户以哪个组的身份登录，就拥有对应组的权限。\n我们可以通过 newgrp 临时切换到 docker 组，来测试 jenkins 用户是否有权限使用 docker：\n$ newgrp docker $ id uid=1000(jenkins) gid=995 groups=998 $ docker version # ... OK！ 从上面的切换方式可以看出，jenkins 已经有了权限，但是重新登录后，又会回到原来的组，而且仅仅是当前切换后的会话才有权限，在项目中使用 docker 还是没有权限的。\n永久解决\n既然修改登录的组，就能获取权限，那该如何彻底解决呢？\n前面提到，docker-compose 配置了用户 id 和组 id，这将会使用户以该配置的运行，所以，我们只需要把组 id 指定为和宿主机一样的 docker 组 id 即可。\n从最前面给出的 docker-compose 配置文件，可以看出给 user 的配置是 1000:995，1000 是宿主机的用户，Jenkins 是该用户部署的，默认用户是 jenkins（1000），配置一样的 id，可以避免映射处理的文件的读写权限问题；995 是宿主机 docker 的组 id，这样容器内部的用户就会以 1000：955 的身份登录。\n# 宿主机的 docker 组 id $ cat /etc/group | grep docker docker:x:995:springx 小结\n对于容器内的 Jenkins，想要使用宿主机的 docker，只需要在 docker-compose.yaml 中配置 user，指定宿主机 docker 组 id 即可，并不需要在容器内创建 docker 组（实际 Jenkins 容器内并不存在 995 的组，但这并不影响）\nversion: '3.9' services: jenkins: image: jenkins/jenkins:jdk17 container_name: jenkins # 指定用户 uid:gid（`用户id`:`docker组id`，跟文件权限有关） # 只要 995 这个值与宿主机的 docker 组 id（使用 `cat /etc/group | grep docker` 查看）一致即可！ user: 1000:995 2.2 映射目录权限问题 映射到宿主机的目录和文件，同样会遇到权限问题，这个与上面 docker 权限问题相比简单至极。\n要么，开放映射目录（.jenkins_home）的所有权限。（这样似乎不太好？反正我感觉不好，但我没证据~）\n$ chmod 777 .jenkins_home 要么，切换映射目录的归属。例如，我使用普通用户 springx（1000:1000）部署 Jenkins，目录所有者就是 1000，刚好 Jenkins 容器内部默认用户 jenkins 也是 1000:1000，所以，只要用 springx 用户先创建 .jenkins_home，然后配置 docker-compose 指定 user: 1000:gid 即可。\n[springx@fun ~]$ mkdir .jenkins_home # 如果使用其他用户创建，需要修改权限 [springx@fun ~]$ chwon 1000:1000 .jenkins_home 如果没有提前创建 .jenkins_home，它的默认所有者是 root，此时如果使用普通用户部署（就如上诉使用 1000 用户部署），容器内部的用户是没有权限的：\n$ docker-compose up [+] Running 2/1 ✔ Network jenkins2_default Created ✔ Container jenkins2 Created Attaching to jenkins2 jenkins2 | touch: cannot touch '/var/jenkins_home/copy_reference_file.log': Permission denied jenkins2 | Can not write to /var/jenkins_home/copy_reference_file.log. Wrong volume permissions? jenkins2 exited with code 0 这里 /var/jenkins_home 映射到了 .jenkins_home 如果配置了重启策略 restart: unless-stopped，只需要修改 chown springx:springx .jenkins_home，然后等待重启即可。 如果执行 docker-compose 的命令是我的普通用户 springx，那么 .jenkins_home 是会有权限的，只不过我没有把 springx 用户加入 docker 组，而是用 sudo 执行的 小结\n如果使用 root 用户部署，映射目录不会有权限问题；如果使用普通用户部署，需要先创建映射目录，并配置相应的权限，否则自动创建的映射目录，属于执行执行创建命令的用户所有，如果用户 id 不一致，会出现无法写入的问题（我用的 sudo，则创建的文件的所有者都是 root）。\n总结 使用 docker-compose 部署 Jenkins，主要涉及几个权限问题，其中主要的是 docker 权限和映射目录的权限：\ndocker 权限可以使用 root 部署，或者修改 docker.sock 权限（不建议）；也可以通过配置，把容器内部的用户，添加到和宿主机 docker 组一样的 id 组即可（user: 1000:995）。\n映射目录权限，可以先手动创建，然后分配给相应的用户，并且 docker-compose 配置对应的用户 id 即可；也可以创建后，再修改权限，等待容器自动重启即可。\n","wordCount":"610","inLanguage":"en","image":"https://blog.springx.fun/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2023-08-21T21:39:09+08:00","dateModified":"2023-08-21T21:39:09+08:00","author":[{"@type":"Person","name":"Spring","url":"https://blog.springx.fun"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.springx.fun/posts/tech/docker-compose-install-jenkins/"},"publisher":{"@type":"Organization","name":"酸辣土豆丝 iCS","logo":{"@type":"ImageObject","url":"https://blog.springx.fun/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.springx.fun/ accesskey=h title="酸辣土豆丝 iCS (Alt + H)"><img src=https://blog.springx.fun/favicon.png alt aria-label=logo height=35>酸辣土豆丝 iCS</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.springx.fun/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://blog.springx.fun/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.springx.fun/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.springx.fun/>Home</a>&nbsp;»&nbsp;<a href=https://blog.springx.fun/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">使用 Docker-Compose 搭建 Jenkins</h1><div class=post-description>这篇文章介绍了使用 Docker 搭建 Jenkins 的主要安装步骤和权限问题处理。对于 Docker 权限问题，可以将容器内部的用户添加到宿主机的 Docker 组中；对于映射目录权限问题，可以手动创建目录并分配权限，或者修改已创建目录的权限。</div><div class=post-meta><span title='2023-08-21 21:39:09 +0800 CST'>August 21, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;610 words&nbsp;·&nbsp;Spring&nbsp;|&nbsp;<a href=https://github.com/heyzqq/heyzqq-content.github.io/tree/main/content/posts/tech/docker-compose-install-jenkins.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#00-碎碎念>00 碎碎念</a></li><li><a href=#01-docker-compose-安装>01 Docker Compose 安装</a></li><li><a href=#02-问题及解决办法>02 问题及解决办法</a><ul><li><a href=#21-docker-权限问题permission-denied>2.1 Docker 权限问题（Permission denied）</a></li><li><a href=#22-映射目录权限问题>2.2 映射目录权限问题</a></li></ul></li><li><a href=#总结>总结</a></li></ul></nav></div></details></div><div class=post-content><h2 id=00-碎碎念>00 碎碎念<a hidden class=anchor aria-hidden=true href=#00-碎碎念>#</a></h2><p><strong>为什么使用 Docker 去搭建 Jenkins 呢？</strong></p><p>主要原因是个人频繁切换环境，有时候在本地虚拟机玩，有时候会在云服务器上折腾，渐感被自己折磨过多了，因此希望能够创建一个配置文件，以便一键启动并快速方便地使用。另外，自己经常在其他地方装环境，公司的服务也比较老，一但要迁移，用 Docker 就很方便。所以，使用 Docker 是很适合的。</p><p><strong>网上那么多一样的文章，为什么要写这篇呢？</strong></p><p>虽然说这篇文章是作为笔记的，但是因为自己在使用网上的方法安装的时候，遇到几个问题，尝试了很多方法才成功，所以想要记录一下，以备不时之需。</p><h2 id=01-docker-compose-安装>01 Docker Compose 安装<a hidden class=anchor aria-hidden=true href=#01-docker-compose-安装>#</a></h2><p>以下是测试过的，能正常部署和使用 Jenkins 的 Docker Compose 配置，部分参数请按需调整。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-YAML data-lang=YAML><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3.9&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># 镜像选择了 jdk17 最新版，可自行选择</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>jenkins/jenkins:jdk17</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>jenkins</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># 重启策略：除非手动停止，否则出错会无限重启</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># 指定用户 uid:gid（`用户id`:`宿主机的docker组id`，跟文件权限有关）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=m>1000</span><span class=p>:</span><span class=m>995</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 8080 为 Jenkins 的 Web 端口</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>9001</span><span class=p>:</span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 50000 为代理节点与主服务器的通信端口？</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>50001</span><span class=p>:</span><span class=m>50000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 同步宿主机的时间</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/etc/timezone:/etc/timezone</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/etc/localtime:/etc/localtime</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Jenkins 数据目录映射出来，方面操作和备份</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>.jenkins_home:/var/jenkins_home</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 把宿主机的 docker 和 docker-compose 给 Jenkins 使用，这样可以直接在 Jenkins 内部打镜像，并直接操作容器</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/usr/bin/docker:/usr/bin/docker</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/var/run/docker.sock:/var/run/docker.sock</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/usr/local/bin/docker-compose:/usr/local/bin/docker-compose</span><span class=w>
</span></span></span></code></pre></div><p>使用 Docker Compose 直接启动即可：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SH data-lang=SH><span class=line><span class=cl><span class=c1># -d：后台启动</span>
</span></span><span class=line><span class=cl>$ docker-compose up -d
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. 查看日志，临时登录密码会放到文件中，也会直接打在日志上</span>
</span></span><span class=line><span class=cl><span class=c1>#    临时密码位置：/var/jenkins_home/secrets/initialAdminPassword</span>
</span></span><span class=line><span class=cl><span class=c1># 2. 或使用 docker 命令查看： docker logs jenkins</span>
</span></span><span class=line><span class=cl>$ docker-compose logs -f
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Jenkins initial setup is required.An admin user has been created and a password generated.
</span></span><span class=line><span class=cl>Please use the following password to proceed to installation:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 临时密码</span>
</span></span><span class=line><span class=cl>57ea14a04f9464d895655348d6ad6a86
</span></span></code></pre></div><p>然后，访问 9001（这里已经映射为 9001 端口了）：<code>http://ip:9001</code>，输入临时密码登录。</p><p>接着，选择安装插件，创建用户，等待完成即可。（这些步骤都可以跳过，后续再进行即可）</p><h2 id=02-问题及解决办法>02 问题及解决办法<a hidden class=anchor aria-hidden=true href=#02-问题及解决办法>#</a></h2><h3 id=21-docker-权限问题permission-denied>2.1 Docker 权限问题（Permission denied）<a hidden class=anchor aria-hidden=true href=#21-docker-权限问题permission-denied>#</a></h3><p><strong>用网上的方法，折腾了好久……</strong></p><p>把 Docker 相关文件映射到容器内部后，会遇到权限问题（<strong>如果直接指定 root 用户部署，不会有权限问题！</strong>），网上有许多把 jenkins 用户添加到 docker 组的方式，但这依然是基于宿主机的环境，未必能直接解决。</p><p>我比较爱折腾，环境稍微有差异，直接把 jenkins 用户添加到 docker 组依然有权限问题，接下来看看具体的情况和处理方法。</p><p><strong>事情是这样子的~</strong></p><p>首先，来看看 <code>docker.sock</code> 在 Jenkins 容器内部的情况：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SH data-lang=SH><span class=line><span class=cl>jenkins@b0e6d3e8ce07:~$ ls -l /var/run/ <span class=p>|</span> grep docker
</span></span><span class=line><span class=cl>srw-rw----. <span class=m>1</span> root  <span class=m>998</span> <span class=m>0</span> Jun  <span class=m>3</span> 01:59 docker.sock
</span></span></code></pre></div><p><code>docker.sock</code> 是我们从宿主机映射到容器内的 sock 文件，它是 Docker 守护进程（Docker daemon）与 Docker 客户端之间进行通信的 UNIX 套接字文件（UNIX socket file）。</p><p>由于 docker 相关文件是属于宿主机的，原则上不直接修改它，而是通过修改容器来兼容。但是，这里的 sock 属于 root 用户，如果使用普通用户（默认 jenkins:1000）部署，并没有权限去读取。</p><p><code>998</code> 是 docker 组的组 id（gid），网上找到比较好的方法是，把 jenkins 用户直接加入该组，就可以正常使用宿主机 docker 了。</p><p>而我的问题就出在这里。</p><p><strong>先用网上的方法试试？</strong></p><p>接着，来看下容器内部的情况：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SH data-lang=SH><span class=line><span class=cl>jenkins@b0e6d3e8ce07:~$ id jenkins
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>jenkins<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>jenkins<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>jenkins<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>jenkins@b0e6d3e8ce07:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>jenkins<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span><span class=m>995</span> <span class=nv>groups</span><span class=o>=</span><span class=m>995</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 下面是配置 `user: root` 部署的，容器内部使用 root 用户，可以正常使用 docker</span>
</span></span><span class=line><span class=cl>root@8900354a95f1:/# id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</span></span></code></pre></div><p>第一个命令，<code>id jenkins</code> 表明 jenkins 用户的用户 id 和组 id 都为 1000；<br>第二个命令，<code>id</code> 表明当前登录会话的用户 id 为 1000，而组 id 和 groups 为 995（为什么不一样？因为 docker-compose 配置文件设置的，<strong>groups 就是重点</strong>）。</p><p>也就是说，当前登录会话的用户，既不是 root 用户，也不属于 998 组，所有没有权限读取 <code>docker.sock</code>。</p><p>所以，到这儿得先把 jenkins 加入 998 组，否则不可能有权限的。这个 docker 组应该不存在，我们需要先创建该组，然后再把 jenkins 加入：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SH data-lang=SH><span class=line><span class=cl><span class=c1># 先退出容器，使用 root 登录（-u 指定登录用户）</span>
</span></span><span class=line><span class=cl>$ sudo docker <span class=nb>exec</span> -it -u root jenkins bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 然后，创建 docker 组，指定与 docker.sock 一样的组 id</span>
</span></span><span class=line><span class=cl><span class=c1># groupadd -g &lt;gid&gt; &lt;group_name&gt;</span>
</span></span><span class=line><span class=cl>$ groupadd -g <span class=m>998</span> docker
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 最后，把 jenkins 加入该组</span>
</span></span><span class=line><span class=cl><span class=c1># usermod -a -G &lt;group_name&gt; &lt;username&gt;</span>
</span></span><span class=line><span class=cl>$ usermod -aG docker jenkins
</span></span></code></pre></div><p>到这一步，我还是没有权限，重启容器也没有用，这是为什么呢？</p><p><strong>一路走到黑？</strong></p><p>折腾了很久都没效果，本来已经要放弃了，就在宿主机试验了一遍：docker 组已经存在，把普通用户加入 docker，重新登录，普通用户居然有权限了！</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SH data-lang=SH><span class=line><span class=cl><span class=o>[</span>springx@** ~<span class=o>]</span>$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>springx<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>springx<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>springx<span class=o>)</span>,995<span class=o>(</span>docker<span class=o>)</span> <span class=nv>context</span><span class=o>=</span>un...
</span></span></code></pre></div><p>可以看出，在宿主机中，当前登录的用户的会话是包含 docker 组的（groups = 1000，995，宿主机的 docker 组 id 正好为 995）。</p><p>相反的是，在容器内部，即使修改了用户组，登录会话的组还是 docker-compose 配置的 995（groups），所以怎么试都没有权限。</p><p>找到问题的根源：<strong>有没有权限，与登录会话有关，需要拥有 docker 组的权限才可以。</strong></p><p>既然知道了问题的根源，那如何让登录会话拥有 docker 组权限呢？</p><p><strong>临时测试方法（<code>newgrp</code>）</strong></p><p>想要修改登录会话所属组，就要修改登录身份。也就是说，用户以哪个组的身份登录，就拥有对应组的权限。</p><p>我们可以通过 <code>newgrp</code> 临时切换到 docker 组，来测试 jenkins 用户是否有权限使用 docker：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SH data-lang=SH><span class=line><span class=cl>$ newgrp docker
</span></span><span class=line><span class=cl>$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>jenkins<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span><span class=m>995</span> <span class=nv>groups</span><span class=o>=</span><span class=m>998</span>
</span></span><span class=line><span class=cl>$ docker version
</span></span><span class=line><span class=cl><span class=c1># ... OK！</span>
</span></span></code></pre></div><p>从上面的切换方式可以看出，jenkins 已经有了权限，但是重新登录后，又会回到原来的组，而且仅仅是当前切换后的会话才有权限，在项目中使用 docker 还是没有权限的。</p><p><strong>永久解决</strong></p><p>既然修改登录的组，就能获取权限，那该如何彻底解决呢？</p><p>前面提到，docker-compose 配置了用户 id 和组 id，这将会使用户以该配置的运行，<strong>所以，我们只需要把组 id 指定为和宿主机一样的 docker 组 id 即可</strong>。</p><p>从最前面给出的 docker-compose 配置文件，可以看出给 <code>user</code> 的配置是 <code>1000:995</code>，1000 是宿主机的用户，Jenkins 是该用户部署的，默认用户是 jenkins（1000），配置一样的 id，可以避免映射处理的文件的读写权限问题；995 是宿主机 docker 的组 id，这样容器内部的用户就会以 <code>1000：955</code> 的身份登录。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SH data-lang=SH><span class=line><span class=cl><span class=c1># 宿主机的 docker 组 id</span>
</span></span><span class=line><span class=cl>$ cat /etc/group <span class=p>|</span> grep docker
</span></span><span class=line><span class=cl>docker:x:995:springx
</span></span></code></pre></div><p><strong>小结</strong></p><p>对于容器内的 Jenkins，想要使用宿主机的 docker，只需要在 docker-compose.yaml 中配置 user，指定宿主机 docker 组 id 即可，并不需要在容器内创建 docker 组（实际 Jenkins 容器内并不存在 995 的组，但这并不影响）</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-YAML data-lang=YAML><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3.9&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>jenkins/jenkins:jdk17</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>jenkins</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># 指定用户 uid:gid（`用户id`:`docker组id`，跟文件权限有关）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># 只要 995 这个值与宿主机的 docker 组 id（使用 `cat /etc/group | grep docker` 查看）一致即可！</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=m>1000</span><span class=p>:</span><span class=m>995</span><span class=w>
</span></span></span></code></pre></div><h3 id=22-映射目录权限问题>2.2 映射目录权限问题<a hidden class=anchor aria-hidden=true href=#22-映射目录权限问题>#</a></h3><p>映射到宿主机的目录和文件，同样会遇到权限问题，这个与上面 docker 权限问题相比简单至极。</p><p>要么，开放映射目录（<code>.jenkins_home</code>）的所有权限。（这样似乎不太好？反正我感觉不好，但我没证据~）</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SH data-lang=SH><span class=line><span class=cl>$ chmod <span class=m>777</span> .jenkins_home
</span></span></code></pre></div><p>要么，切换映射目录的归属。例如，我使用普通用户 springx（1000:1000）部署 Jenkins，目录所有者就是 1000，刚好 Jenkins 容器内部默认用户 jenkins 也是 1000:1000，所以，只要用 springx 用户先创建 <code>.jenkins_home</code>，然后配置 docker-compose 指定 <code>user: 1000:gid</code> 即可。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SH data-lang=SH><span class=line><span class=cl><span class=o>[</span>springx@fun ~<span class=o>]</span>$ mkdir .jenkins_home
</span></span><span class=line><span class=cl><span class=c1># 如果使用其他用户创建，需要修改权限</span>
</span></span><span class=line><span class=cl><span class=o>[</span>springx@fun ~<span class=o>]</span>$ chwon 1000:1000 .jenkins_home
</span></span></code></pre></div><p>如果没有提前创建 <code>.jenkins_home</code>，它的默认所有者是 root，此时如果使用普通用户部署（就如上诉使用 1000 用户部署），容器内部的用户是没有权限的：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SH data-lang=SH><span class=line><span class=cl>$ docker-compose up
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Running 2/1
</span></span><span class=line><span class=cl> ✔ Network jenkins2_default  Created          
</span></span><span class=line><span class=cl> ✔ Container jenkins2           Created          
</span></span><span class=line><span class=cl>Attaching to jenkins2
</span></span><span class=line><span class=cl>jenkins2  <span class=p>|</span> touch: cannot touch <span class=s1>&#39;/var/jenkins_home/copy_reference_file.log&#39;</span>: Permission denied
</span></span><span class=line><span class=cl>jenkins2  <span class=p>|</span> Can not write to /var/jenkins_home/copy_reference_file.log. Wrong volume permissions?
</span></span><span class=line><span class=cl>jenkins2 exited with code <span class=m>0</span>
</span></span></code></pre></div><ul><li>这里 <code>/var/jenkins_home</code> 映射到了 <code>.jenkins_home</code></li><li>如果配置了重启策略 <code>restart: unless-stopped</code>，只需要修改 <code>chown springx:springx .jenkins_home</code>，然后等待重启即可。</li><li>如果执行 <code>docker-compose</code> 的命令是我的普通用户 springx，那么 <code>.jenkins_home</code> 是会有权限的，只不过我没有把 springx 用户加入 docker 组，而是用 sudo 执行的</li></ul><p><strong>小结</strong></p><p>如果使用 root 用户部署，映射目录不会有权限问题；如果使用普通用户部署，需要先创建映射目录，并配置相应的权限，否则自动创建的映射目录，属于执行执行创建命令的用户所有，如果用户 id 不一致，会出现无法写入的问题（我用的 sudo，则创建的文件的所有者都是 root）。</p><h2 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h2><p>使用 docker-compose 部署 Jenkins，主要涉及几个权限问题，其中主要的是 docker 权限和映射目录的权限：</p><p>docker 权限可以使用 root 部署，或者修改 <code>docker.sock</code> 权限（不建议）；也可以通过配置，把容器内部的用户，添加到和宿主机 docker 组一样的 id 组即可（<code>user: 1000:995</code>）。</p><p>映射目录权限，可以先手动创建，然后分配给相应的用户，并且 docker-compose 配置对应的用户 id 即可；也可以创建后，再修改权限，等待容器自动重启即可。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.springx.fun/tags/tech/>Tech</a></li><li><a href=https://blog.springx.fun/tags/docker/>Docker</a></li><li><a href=https://blog.springx.fun/tags/jenkins/>Jenkins</a></li></ul><nav class=paginav><a class=prev href=https://blog.springx.fun/posts/tech/tomcat-appears-to-still-be-running-with-pid/><span class=title>« Prev</span><br><span>Tomcat 停止后无法启动，“Tomcat appears to still be running with PID ...”</span>
</a><a class=next href=https://blog.springx.fun/posts/tech/proxy-for-terminal-and-git/><span class=title>Next »</span><br><span>如何为终端或 Git 设置代理？</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Docker-Compose 搭建 Jenkins on x" href="https://x.com/intent/tweet/?text=%e4%bd%bf%e7%94%a8%20Docker-Compose%20%e6%90%ad%e5%bb%ba%20Jenkins&amp;url=https%3a%2f%2fblog.springx.fun%2fposts%2ftech%2fdocker-compose-install-jenkins%2f&amp;hashtags=tech%2cdocker%2cjenkins"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Docker-Compose 搭建 Jenkins on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.springx.fun%2fposts%2ftech%2fdocker-compose-install-jenkins%2f&amp;title=%e4%bd%bf%e7%94%a8%20Docker-Compose%20%e6%90%ad%e5%bb%ba%20Jenkins&amp;summary=%e4%bd%bf%e7%94%a8%20Docker-Compose%20%e6%90%ad%e5%bb%ba%20Jenkins&amp;source=https%3a%2f%2fblog.springx.fun%2fposts%2ftech%2fdocker-compose-install-jenkins%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Docker-Compose 搭建 Jenkins on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.springx.fun%2fposts%2ftech%2fdocker-compose-install-jenkins%2f&title=%e4%bd%bf%e7%94%a8%20Docker-Compose%20%e6%90%ad%e5%bb%ba%20Jenkins"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Docker-Compose 搭建 Jenkins on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.springx.fun%2fposts%2ftech%2fdocker-compose-install-jenkins%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Docker-Compose 搭建 Jenkins on whatsapp" href="https://api.whatsapp.com/send?text=%e4%bd%bf%e7%94%a8%20Docker-Compose%20%e6%90%ad%e5%bb%ba%20Jenkins%20-%20https%3a%2f%2fblog.springx.fun%2fposts%2ftech%2fdocker-compose-install-jenkins%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Docker-Compose 搭建 Jenkins on telegram" href="https://telegram.me/share/url?text=%e4%bd%bf%e7%94%a8%20Docker-Compose%20%e6%90%ad%e5%bb%ba%20Jenkins&amp;url=https%3a%2f%2fblog.springx.fun%2fposts%2ftech%2fdocker-compose-install-jenkins%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Docker-Compose 搭建 Jenkins on ycombinator" href="https://news.ycombinator.com/submitlink?t=%e4%bd%bf%e7%94%a8%20Docker-Compose%20%e6%90%ad%e5%bb%ba%20Jenkins&u=https%3a%2f%2fblog.springx.fun%2fposts%2ftech%2fdocker-compose-install-jenkins%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://blog.springx.fun/>酸辣土豆丝 iCS</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>